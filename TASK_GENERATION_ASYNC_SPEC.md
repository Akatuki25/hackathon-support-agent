# ã‚¿ã‚¹ã‚¯ç”Ÿæˆã®éåŒæœŸåŒ–ã¨ç’°å¢ƒæ§‹ç¯‰ãƒšãƒ¼ã‚¸å…ˆè¡Œè¡¨ç¤ºã®å®Ÿè£…ä»•æ§˜æ›¸

## æ¦‚è¦

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒšãƒ¼ã‚¸ã®ãƒ•ãƒ­ãƒ¼ã‚’æ”¹å–„ã—ã€ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚’éåŒæœŸãƒãƒƒãƒå‡¦ç†ã¨ã—ã¦å®Ÿè¡Œã—ãªãŒã‚‰ã€å…ˆã«ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†ã‚’å¾…ã¤é–“ã«ä½œæ¥­ã‚’é–‹å§‹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

## ç¾åœ¨ã®ãƒ•ãƒ­ãƒ¼

```
[userName]/[projectId]/page.tsx
  â†“
ã‚¿ã‚¹ã‚¯ã‚’åŒæœŸçš„ã«ç”Ÿæˆï¼ˆæ•°åˆ†ã‹ã‹ã‚‹ï¼‰
  â†“
ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¡¨ç¤º
```

**å•é¡Œç‚¹:**
- ã‚¿ã‚¹ã‚¯ç”ŸæˆãŒå®Œäº†ã™ã‚‹ã¾ã§ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã®ã¿ï¼‰
- ç”Ÿæˆä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä½•ã‚‚ã§ããªã„
- ã‚¿ã‚¹ã‚¯ç”Ÿæˆã¨ãƒãƒ³ã‚ºã‚ªãƒ³è³‡æ–™ç”Ÿæˆã®é †åºãŒéåŠ¹ç‡

## æ–°ã—ã„ãƒ•ãƒ­ãƒ¼

```
[userName]/[projectId]/page.tsx
  â†“
ã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ãªã„ï¼Ÿ
  â†“ Yes
[userName]/[projectId]/env/page.tsx
  â”œâ”€ ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–ã‚’éåŒæœŸã§é–‹å§‹ï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼‰
  â”œâ”€ ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’ç”Ÿæˆãƒ»è¡¨ç¤ºï¼ˆå…ˆã«è¡¨ç¤ºï¼‰
  â”œâ”€ ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†ã‚’ç›£è¦–ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰
  â””â”€ å®Œäº†æ™‚ã«é€šçŸ¥ â†’ ã‚°ãƒ©ãƒ•/ã‚«ãƒ³ãƒãƒ³ã¸èª˜å°
  â†“ No
ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¡¨ç¤º
```

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¾…ã¡æ™‚é–“ä¸­ã«ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’ç¢ºèªã§ãã‚‹
- ã‚¿ã‚¹ã‚¯ç”ŸæˆãŒå®Œäº†ã—ãŸã‚‰é€šçŸ¥ã—ã¦æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚ã‚‹
- ãƒšãƒ¼ã‚¸é·ç§»ãŒã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚Šã€UXãŒå‘ä¸Š

---

## å®Ÿè£…è©³ç´°

### Phase 1: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ”¹ä¿®

#### 1.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒè¿½åŠ 

**æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«: `task_generation_job`**

ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ï¼ˆ`models/project_base.py`ã«è¿½åŠ ï¼‰

```python
class TaskGenerationJob(Base):
    """ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«"""
    __tablename__ = "task_generation_job"

    job_id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)
    project_id = Column(UUID(as_uuid=True), ForeignKey("project_base.project_id"), nullable=False)

    # ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    status = Column(String, nullable=False, default="queued")  # queued, processing, completed, failed

    # é€²æ—æƒ…å ±
    total_tasks = Column(Integer, default=0)
    completed_phases = Column(Integer, default=0)
    total_phases = Column(Integer, default=5)  # ç”Ÿæˆã€è©•ä¾¡ã€ä¾å­˜é–¢ä¿‚ã€åº§æ¨™ã€ä¿å­˜

    # ã‚¨ãƒ©ãƒ¼æƒ…å ±
    error_message = Column(String, nullable=True)

    # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
    created_at = Column(DateTime, default=datetime.utcnow)
    started_at = Column(DateTime, nullable=True)
    completed_at = Column(DateTime, nullable=True)

    # ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    project = relationship("ProjectBase", back_populates="task_generation_jobs")
```

**ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ:**

```bash
cd back
alembic revision --autogenerate -m "Add task_generation_job table"
alembic upgrade head
```

---

#### 1.2 Celeryã‚¿ã‚¹ã‚¯ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«: `back/tasks/task_generation_tasks.py`**

```python
"""
task_generation_tasks.py: ã‚¿ã‚¹ã‚¯ç”Ÿæˆã®Celeryã‚¿ã‚¹ã‚¯

Phase 1: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã®å®Œå…¨ã‚¿ã‚¹ã‚¯ç”Ÿæˆ
"""

from celery_app import celery_app
from database import SessionLocal
from models.project_base import TaskGenerationJob
from services.integrated_task_service import IntegratedTaskService
from datetime import datetime
from uuid import UUID


@celery_app.task(bind=True, max_retries=3, retry_backoff=True)
def generate_complete_task_set_async(self, job_id: str, project_id: str):
    """
    å®Œå…¨ãªã‚¿ã‚¹ã‚¯ã‚»ãƒƒãƒˆã‚’éåŒæœŸç”Ÿæˆ

    Args:
        job_id: TaskGenerationJob ID
        project_id: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID

    Returns:
        Dict: ç”Ÿæˆçµæœ
    """
    db = SessionLocal()

    try:
        print(f"[Celery] ã‚¿ã‚¹ã‚¯ç”Ÿæˆé–‹å§‹: project_id={project_id}")

        # ã‚¸ãƒ§ãƒ–ãƒ¬ã‚³ãƒ¼ãƒ‰å–å¾—ãƒ»æ›´æ–°
        job = db.query(TaskGenerationJob).filter_by(job_id=UUID(job_id)).first()
        if not job:
            raise ValueError(f"Job {job_id} not found")

        job.status = "processing"
        job.started_at = datetime.utcnow()
        db.commit()

        # ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹å®Ÿè¡Œ
        service = IntegratedTaskService(db)
        result = await service.generate_complete_task_set(project_id)

        # ã‚¸ãƒ§ãƒ–å®Œäº†
        job.status = "completed"
        job.completed_at = datetime.utcnow()
        job.total_tasks = result["total_tasks"]
        job.completed_phases = 5  # ã™ã¹ã¦ã®ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†
        db.commit()

        print(f"[Celery] ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†: {result['total_tasks']} tasks")

        return {
            "success": True,
            "job_id": job_id,
            "project_id": project_id,
            **result
        }

    except Exception as e:
        # ã‚¨ãƒ©ãƒ¼å‡¦ç†
        job.status = "failed"
        job.error_message = str(e)
        db.commit()

        print(f"[Celery] ã‚¿ã‚¹ã‚¯ç”Ÿæˆå¤±æ•—: {str(e)}")

        # ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ãªã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒªãƒˆãƒ©ã‚¤
        if "timeout" in str(e).lower() or "network" in str(e).lower():
            raise self.retry(exc=e, countdown=60)

        raise

    finally:
        db.close()
```

**Celeryã‚¢ãƒ—ãƒªè¨­å®šæ›´æ–°: `back/celery_app.py`**

```python
# ã‚¿ã‚¹ã‚¯è‡ªå‹•æ¤œå‡ºï¼ˆtasksãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ï¼‰
imports=[
    "tasks.hands_on_tasks",  # Phase 3: ãƒãƒ³ã‚ºã‚ªãƒ³ç”Ÿæˆã‚¿ã‚¹ã‚¯
    "tasks.task_generation_tasks",  # Phase 1: ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¿ã‚¹ã‚¯ï¼ˆè¿½åŠ ï¼‰
],
```

---

#### 1.3 APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«: `back/routers/complete_task_generation.py`**

æ—¢å­˜ã®APIã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ‹¡å¼µ:

```python
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from pydantic import BaseModel
from typing import Dict, Any, Optional
from database import get_db
from tasks.task_generation_tasks import generate_complete_task_set_async
from models.project_base import TaskGenerationJob, Task
from uuid import UUID, uuid4
from datetime import datetime
from sqlalchemy import and_

router = APIRouter()


# ========================================
# ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«
# ========================================

class AsyncTaskGenerationRequest(BaseModel):
    """éåŒæœŸã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ"""
    project_id: str


class AsyncTaskGenerationResponse(BaseModel):
    """éåŒæœŸã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ¬ã‚¹ãƒãƒ³ã‚¹"""
    success: bool
    job_id: str
    project_id: str
    status: str
    message: str


class JobStatusResponse(BaseModel):
    """ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¹ãƒãƒ³ã‚¹"""
    success: bool
    job_id: str
    project_id: str
    status: str
    progress: Dict[str, Any]
    total_tasks: int
    completed_phases: int
    total_phases: int
    error_message: Optional[str]
    created_at: Optional[str]
    started_at: Optional[str]
    completed_at: Optional[str]


# ========================================
# ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
# ========================================

@router.post("/generate_async", response_model=AsyncTaskGenerationResponse)
async def generate_complete_task_set_async_endpoint(
    request: AsyncTaskGenerationRequest,
    db: Session = Depends(get_db)
):
    """
    éåŒæœŸã§ã‚¿ã‚¹ã‚¯ã‚»ãƒƒãƒˆç”Ÿæˆã‚’é–‹å§‹

    Celeryã‚¿ã‚¹ã‚¯ã‚’èµ·å‹•ã—ã¦å³åº§ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´

    é‡è¤‡å®Ÿè¡Œé˜²æ­¢:
    - æ—¢å­˜ã®ã‚¸ãƒ§ãƒ–(queued/processing/completed)ã‚’ãƒã‚§ãƒƒã‚¯
    - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§æ’ä»–åˆ¶å¾¡
    """
    try:
        project_uuid = UUID(request.project_id)

        # ğŸ”’ æ—¢å­˜ã®ã‚¸ãƒ§ãƒ–ã‚’ãƒã‚§ãƒƒã‚¯ (å‡¦ç†ä¸­ or å®Œäº†æ¸ˆã¿)
        existing_job = (
            db.query(TaskGenerationJob)
            .filter(
                and_(
                    TaskGenerationJob.project_id == project_uuid,
                    TaskGenerationJob.status.in_(["queued", "processing", "completed"])
                )
            )
            .with_for_update(skip_locked=True)
            .first()
        )

        if existing_job:
            return AsyncTaskGenerationResponse(
                success=True,
                job_id=str(existing_job.job_id),
                project_id=request.project_id,
                status=existing_job.status,
                message=f"Task generation already {existing_job.status}"
            )

        # ğŸ”’ ã‚¿ã‚¹ã‚¯ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        existing_tasks = db.query(Task).filter_by(project_id=project_uuid).first()
        if existing_tasks:
            return AsyncTaskGenerationResponse(
                success=True,
                job_id="already-completed",
                project_id=request.project_id,
                status="completed",
                message="Tasks already exist for this project"
            )

        # ğŸ†• æ–°è¦ã‚¸ãƒ§ãƒ–ä½œæˆ
        job = TaskGenerationJob(
            job_id=uuid4(),
            project_id=project_uuid,
            status="queued"
        )
        db.add(job)
        db.commit()

        # Celeryã‚¿ã‚¹ã‚¯èµ·å‹•ï¼ˆéåŒæœŸï¼‰
        generate_complete_task_set_async.apply_async(
            args=[str(job.job_id), request.project_id],
            task_id=str(job.job_id)
        )

        return AsyncTaskGenerationResponse(
            success=True,
            job_id=str(job.job_id),
            project_id=request.project_id,
            status="queued",
            message="Task generation started in background"
        )

    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@router.get("/job_status/{job_id}", response_model=JobStatusResponse)
async def get_job_status(
    job_id: str,
    db: Session = Depends(get_db)
):
    """
    ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
    """
    try:
        job = db.query(TaskGenerationJob).filter_by(job_id=UUID(job_id)).first()
        if not job:
            raise ValueError(f"Job {job_id} not found")

        return JobStatusResponse(
            success=True,
            job_id=str(job.job_id),
            project_id=str(job.project_id),
            status=job.status,
            progress={
                "percentage": (job.completed_phases / job.total_phases * 100) if job.total_phases > 0 else 0,
                "current_phase": job.completed_phases,
                "total_phases": job.total_phases
            },
            total_tasks=job.total_tasks,
            completed_phases=job.completed_phases,
            total_phases=job.total_phases,
            error_message=job.error_message,
            created_at=job.created_at.isoformat() if job.created_at else None,
            started_at=job.started_at.isoformat() if job.started_at else None,
            completed_at=job.completed_at.isoformat() if job.completed_at else None
        )

    except ValueError as e:
        raise HTTPException(status_code=404, detail=str(e))
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


# æ—¢å­˜ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ãã®ã¾ã¾ç¶­æŒ
@router.post("/generate_complete", ...)  # æ—¢å­˜ã®åŒæœŸç‰ˆï¼ˆäº’æ›æ€§ã®ãŸã‚æ®‹ã™ï¼‰
@router.get("/preview/{project_id}", ...)  # æ—¢å­˜ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
@router.delete("/clear/{project_id}", ...)  # æ—¢å­˜ã®ã‚¯ãƒªã‚¢
```

---

### Phase 2: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ”¹ä¿®

#### 2.1 æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«: `front/src/libs/service/taskGenerationJobService.ts`**

```typescript
import axios from 'axios';

const API_URL = process.env.NEXT_PUBLIC_API_URL;

/**
 * éåŒæœŸã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ
 */
export interface AsyncTaskGenerationRequest {
  project_id: string;
}

/**
 * éåŒæœŸã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ¬ã‚¹ãƒãƒ³ã‚¹
 */
export interface AsyncTaskGenerationResponse {
  success: boolean;
  job_id: string;
  project_id: string;
  status: string;
  message: string;
}

/**
 * ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¹ãƒãƒ³ã‚¹
 */
export interface JobStatusResponse {
  success: boolean;
  job_id: string;
  project_id: string;
  status: string;  // 'queued' | 'processing' | 'completed' | 'failed'
  progress: {
    percentage: number;
    current_phase: number;
    total_phases: number;
  };
  total_tasks: number;
  completed_phases: number;
  total_phases: number;
  error_message?: string;
  created_at?: string;
  started_at?: string;
  completed_at?: string;
}

/**
 * éåŒæœŸã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚’é–‹å§‹
 */
export const startTaskGenerationAsync = async (
  projectId: string
): Promise<AsyncTaskGenerationResponse> => {
  const response = await axios.post<AsyncTaskGenerationResponse>(
    `${API_URL}/api/complete_task_generation/generate_async`,
    { project_id: projectId }
  );
  return response.data;
};

/**
 * ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—
 */
export const getJobStatus = async (
  jobId: string
): Promise<JobStatusResponse> => {
  const response = await axios.get<JobStatusResponse>(
    `${API_URL}/api/complete_task_generation/job_status/${jobId}`
  );
  return response.data;
};

/**
 * ã‚¸ãƒ§ãƒ–å®Œäº†ã‚’å¾…æ©Ÿï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰
 *
 * @param jobId ã‚¸ãƒ§ãƒ–ID
 * @param onProgress é€²æ—æ›´æ–°ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
 * @param pollingInterval ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰
 * @returns å®Œäº†æ™‚ã®ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
 */
export const waitForJobCompletion = async (
  jobId: string,
  onProgress?: (status: JobStatusResponse) => void,
  pollingInterval: number = 3000
): Promise<JobStatusResponse> => {
  return new Promise((resolve, reject) => {
    const checkStatus = async () => {
      try {
        const status = await getJobStatus(jobId);

        // é€²æ—ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
        if (onProgress) {
          onProgress(status);
        }

        // å®Œäº†ãƒã‚§ãƒƒã‚¯
        if (status.status === 'completed') {
          resolve(status);
        } else if (status.status === 'failed') {
          reject(new Error(status.error_message || 'Task generation failed'));
        } else {
          // ç¶™ç¶šã—ã¦ãƒãƒ¼ãƒªãƒ³ã‚°
          setTimeout(checkStatus, pollingInterval);
        }
      } catch (error) {
        reject(error);
      }
    };

    checkStatus();
  });
};
```

---

#### 2.2 page.tsx ã®æ”¹ä¿®

**ãƒ•ã‚¡ã‚¤ãƒ«: `front/src/app/[userName]/[projectId]/page.tsx`**

æ—¢å­˜ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¿®æ­£ã—ã€ã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ `/env` ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ:

```typescript
// æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰...
import { useRouter } from 'next/navigation';

export default function TaskVisualizationPage() {
  const pathname = usePathname();
  const router = useRouter();
  const projectId = pathname?.split('/')[2];
  const userName = pathname?.split('/')[1];

  // ... æ—¢å­˜ã®state ...

  const loadTaskData = async () => {
    if (!projectId) {
      setError('Project ID not found in URL');
      setLoading(false);
      return;
    }

    try {
      setLoading(true);
      setError(null);

      // Fetch tasks
      const tasksResponse = await axios.get<BackendTask[]>(
        `${API_URL}/task/project/${projectId}`
      );

      // Fetch dependencies
      const dependenciesResponse = await axios.get<BackendTaskDependency[]>(
        `${API_URL}/api/task_dependencies/project/${projectId}`
      );

      const tasks = tasksResponse.data;
      const dependencies = dependenciesResponse.data;

      if (!tasks || tasks.length === 0) {
        // ã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ç’°å¢ƒæ§‹ç¯‰ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        router.push(`/${userName}/${projectId}/env`);
        return;
      }

      // Transform and set data
      const transformedNodes = transformTasksToNodes(tasks);
      const transformedEdges = transformDependenciesToEdges(dependencies);

      setNodes(transformedNodes);
      setEdges(transformedEdges);
    } catch (err) {
      const error = err as { response?: { status?: number; data?: { detail?: string } }; message?: string };
      if (error.response?.status === 404 || error.response?.data?.detail?.includes('not found')) {
        // ã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ç’°å¢ƒæ§‹ç¯‰ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        router.push(`/${userName}/${projectId}/env`);
      } else {
        console.error('Error loading task data:', error);
        setError(
          `ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.response?.data?.detail || error.message}`
        );
      }
    } finally {
      setLoading(false);
    }
  };

  // generateTasks é–¢æ•°ã¯å‰Šé™¤ï¼ˆenv ãƒšãƒ¼ã‚¸ã§å®Ÿè¡Œã™ã‚‹ãŸã‚ï¼‰

  // ... æ®‹ã‚Šã®ã‚³ãƒ¼ãƒ‰ã¯æ—¢å­˜ã®ã¾ã¾ ...
}
```

---

#### 2.3 env/page.tsx ã®æ–°è¦å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«: `front/src/app/[userName]/[projectId]/env/page.tsx`**

```typescript
"use client";
import { useState, useEffect } from 'react';
import { usePathname, useRouter } from 'next/navigation';
import axios from 'axios';
import {
  startTaskGenerationAsync,
  waitForJobCompletion,
  JobStatusResponse
} from '@/libs/service/taskGenerationJobService';
import { useDarkMode } from '@/hooks/useDarkMode';
import { CheckCircle, Loader2, ArrowRight, AlertCircle } from 'lucide-react';

const API_URL = process.env.NEXT_PUBLIC_API_URL;

interface EnvironmentHandsOn {
  overall: string;
  devcontainer: string;
  frontend: string;
  backend: string;
}

export default function EnvironmentSetupPage() {
  const pathname = usePathname();
  const router = useRouter();
  const { darkMode } = useDarkMode();

  const projectId = pathname?.split('/')[2];
  const userName = pathname?.split('/')[1];

  // State
  const [loading, setLoading] = useState<boolean>(true);
  const [error, setError] = useState<string | null>(null);
  const [envData, setEnvData] = useState<EnvironmentHandsOn | null>(null);
  const [taskGenerationJobId, setTaskGenerationJobId] = useState<string | null>(null);
  const [taskGenerationStatus, setTaskGenerationStatus] = useState<JobStatusResponse | null>(null);
  const [showNotification, setShowNotification] = useState<boolean>(false);

  // åˆæœŸåŒ–å‡¦ç†
  useEffect(() => {
    if (projectId) {
      initializePage();
    }
  }, [projectId]);

  const initializePage = async () => {
    try {
      setLoading(true);
      setError(null);

      // 1. ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–ã‚’é–‹å§‹
      await startTaskGeneration();

      // 2. ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’ç”Ÿæˆãƒ»å–å¾—
      await loadEnvironmentData();

      setLoading(false);
    } catch (err) {
      const error = err as { response?: { data?: { detail?: string } }; message?: string };
      console.error('Error initializing page:', error);
      setError(
        `åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.response?.data?.detail || error.message}`
      );
      setLoading(false);
    }
  };

  const startTaskGeneration = async () => {
    if (!projectId) return;

    try {
      console.log('ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–ã‚’é–‹å§‹...');
      const response = await startTaskGenerationAsync(projectId);

      setTaskGenerationJobId(response.job_id);
      console.log(`ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¸ãƒ§ãƒ–é–‹å§‹: ${response.job_id}`);

      // ã‚¸ãƒ§ãƒ–å®Œäº†ã‚’ç›£è¦–
      waitForJobCompletion(
        response.job_id,
        (status) => {
          setTaskGenerationStatus(status);
          console.log(`ã‚¿ã‚¹ã‚¯ç”Ÿæˆé€²æ—: ${status.progress.percentage}%`);
        },
        3000  // 3ç§’ã”ã¨ã«ãƒãƒ¼ãƒªãƒ³ã‚°
      )
        .then((finalStatus) => {
          console.log('ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†!');
          setTaskGenerationStatus(finalStatus);
          setShowNotification(true);
        })
        .catch((err) => {
          console.error('ã‚¿ã‚¹ã‚¯ç”Ÿæˆå¤±æ•—:', err);
          setError(`ã‚¿ã‚¹ã‚¯ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${err.message}`);
        });
    } catch (err) {
      const error = err as { response?: { data?: { detail?: string } }; message?: string };
      console.error('Error starting task generation:', error);
      // ã‚¨ãƒ©ãƒ¼ã§ã‚‚ãƒšãƒ¼ã‚¸ã¯è¡¨ç¤ºã™ã‚‹ï¼ˆç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã¯è¦‹ã‚‰ã‚Œã‚‹ï¼‰
    }
  };

  const loadEnvironmentData = async () => {
    if (!projectId) return;

    try {
      console.log('ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’ç”Ÿæˆä¸­...');
      const response = await axios.post<any>(
        `${API_URL}/api/environment/generate-from-project`,
        { project_id: projectId }
      );

      setEnvData(response.data.hands_on);
      console.log('ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ç”Ÿæˆå®Œäº†');
    } catch (err) {
      const error = err as { response?: { data?: { detail?: string } }; message?: string };
      console.error('Error loading environment data:', error);
      throw new Error(`ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—: ${error.response?.data?.detail || error.message}`);
    }
  };

  const navigateToTaskFlow = () => {
    if (userName && projectId) {
      router.push(`/${userName}/${projectId}`);
    }
  };

  const navigateToKanban = () => {
    if (userName && projectId) {
      router.push(`/${userName}/${projectId}/kanban`);
    }
  };

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢
  if (loading) {
    return (
      <main className={`min-h-screen ${
        darkMode
          ? 'bg-gradient-to-br from-gray-900 via-black to-gray-900'
          : 'bg-gradient-to-br from-purple-50 via-white to-blue-50'
      } p-8`}>
        <div className="max-w-4xl mx-auto text-center">
          <Loader2 className={`w-12 h-12 animate-spin mx-auto mb-4 ${
            darkMode ? 'text-cyan-400' : 'text-purple-600'
          }`} />
          <h2 className={`text-2xl font-bold mb-2 ${
            darkMode ? 'text-cyan-300' : 'text-purple-700'
          }`}>
            åˆæœŸåŒ–ä¸­...
          </h2>
          <p className={darkMode ? 'text-gray-400' : 'text-gray-600'}>
            ã‚¿ã‚¹ã‚¯ç”Ÿæˆã¨ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’æº–å‚™ã—ã¦ã„ã¾ã™
          </p>
        </div>
      </main>
    );
  }

  // ã‚¨ãƒ©ãƒ¼ç”»é¢
  if (error) {
    return (
      <main className={`min-h-screen ${
        darkMode
          ? 'bg-gradient-to-br from-gray-900 via-black to-gray-900'
          : 'bg-gradient-to-br from-purple-50 via-white to-blue-50'
      } p-8`}>
        <div className="max-w-4xl mx-auto text-center">
          <AlertCircle className="w-12 h-12 text-red-500 mx-auto mb-4" />
          <h2 className="text-2xl font-bold mb-2 text-red-600">ã‚¨ãƒ©ãƒ¼</h2>
          <p className={`mb-6 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
            {error}
          </p>
          <button
            onClick={initializePage}
            className="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
          >
            å†è©¦è¡Œ
          </button>
        </div>
      </main>
    );
  }

  // ãƒ¡ã‚¤ãƒ³ç”»é¢
  return (
    <main className={`min-h-screen ${
      darkMode
        ? 'bg-gradient-to-br from-gray-900 via-black to-gray-900'
        : 'bg-gradient-to-br from-purple-50 via-white to-blue-50'
    } p-8`}>
      <div className="max-w-6xl mx-auto">
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <div className="mb-8">
          <h1 className={`text-4xl font-bold mb-2 ${
            darkMode ? 'text-cyan-300' : 'text-purple-700'
          }`}>
            ç’°å¢ƒæ§‹ç¯‰ã‚¬ã‚¤ãƒ‰
          </h1>
          <p className={darkMode ? 'text-gray-400' : 'text-gray-600'}>
            é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’ç¢ºèªã—ã¦ãã ã•ã„
          </p>
        </div>

        {/* ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */}
        <div className={`mb-8 p-6 rounded-lg ${
          darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
        }`}>
          <div className="flex items-center justify-between mb-4">
            <h2 className={`text-xl font-semibold ${
              darkMode ? 'text-cyan-300' : 'text-purple-700'
            }`}>
              ã‚¿ã‚¹ã‚¯ç”ŸæˆçŠ¶æ³
            </h2>
            {taskGenerationStatus?.status === 'completed' && (
              <CheckCircle className="w-6 h-6 text-green-500" />
            )}
            {(taskGenerationStatus?.status === 'processing' || taskGenerationStatus?.status === 'queued') && (
              <Loader2 className={`w-6 h-6 animate-spin ${
                darkMode ? 'text-cyan-400' : 'text-purple-600'
              }`} />
            )}
          </div>

          {taskGenerationStatus && (
            <>
              <div className="mb-2">
                <div className="flex justify-between text-sm mb-1">
                  <span className={darkMode ? 'text-gray-400' : 'text-gray-600'}>
                    é€²æ—: Phase {taskGenerationStatus.progress.current_phase} / {taskGenerationStatus.progress.total_phases}
                  </span>
                  <span className={darkMode ? 'text-gray-400' : 'text-gray-600'}>
                    {taskGenerationStatus.progress.percentage.toFixed(0)}%
                  </span>
                </div>
                <div className={`h-2 rounded-full overflow-hidden ${
                  darkMode ? 'bg-gray-700' : 'bg-gray-200'
                }`}>
                  <div
                    className={`h-full transition-all duration-300 ${
                      darkMode
                        ? 'bg-gradient-to-r from-cyan-500 to-purple-500'
                        : 'bg-gradient-to-r from-purple-500 to-blue-500'
                    }`}
                    style={{ width: `${taskGenerationStatus.progress.percentage}%` }}
                  />
                </div>
              </div>

              <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                {taskGenerationStatus.status === 'completed'
                  ? `âœ… ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº† (${taskGenerationStatus.total_tasks} ã‚¿ã‚¹ã‚¯)`
                  : taskGenerationStatus.status === 'processing'
                  ? 'âš™ï¸ ã‚¿ã‚¹ã‚¯ã‚’ç”Ÿæˆä¸­...'
                  : 'â³ ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚’é–‹å§‹ä¸­...'}
              </p>
            </>
          )}
        </div>

        {/* å®Œäº†é€šçŸ¥ */}
        {showNotification && taskGenerationStatus?.status === 'completed' && (
          <div className={`mb-8 p-6 rounded-lg border-2 ${
            darkMode
              ? 'bg-green-900/20 border-green-500'
              : 'bg-green-50 border-green-500'
          }`}>
            <div className="flex items-start gap-4">
              <CheckCircle className="w-8 h-8 text-green-500 flex-shrink-0 mt-1" />
              <div className="flex-1">
                <h3 className={`text-xl font-bold mb-2 ${
                  darkMode ? 'text-green-300' : 'text-green-700'
                }`}>
                  ã‚¿ã‚¹ã‚¯ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼
                </h3>
                <p className={`mb-4 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                  {taskGenerationStatus.total_tasks} å€‹ã®ã‚¿ã‚¹ã‚¯ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚
                  ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼ã¾ãŸã¯ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰ã§ç¢ºèªã§ãã¾ã™ã€‚
                </p>
                <div className="flex gap-4">
                  <button
                    onClick={navigateToTaskFlow}
                    className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all"
                  >
                    ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¡¨ç¤º
                    <ArrowRight className="w-4 h-4" />
                  </button>
                  <button
                    onClick={navigateToKanban}
                    className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-cyan-600 to-purple-600 text-white rounded-lg hover:from-cyan-700 hover:to-purple-700 transition-all"
                  >
                    ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰ã‚’è¡¨ç¤º
                    <ArrowRight className="w-4 h-4" />
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ */}
        {envData && (
          <div className="space-y-6">
            {/* å…¨ä½“èª¬æ˜ */}
            <section className={`p-6 rounded-lg ${
              darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
            }`}>
              <h2 className={`text-2xl font-bold mb-4 ${
                darkMode ? 'text-cyan-300' : 'text-purple-700'
              }`}>
                å…¨ä½“æ¦‚è¦
              </h2>
              <div
                className={`prose ${darkMode ? 'prose-invert' : ''} max-w-none`}
                dangerouslySetInnerHTML={{ __html: envData.overall }}
              />
            </section>

            {/* DevContainer */}
            <section className={`p-6 rounded-lg ${
              darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
            }`}>
              <h2 className={`text-2xl font-bold mb-4 ${
                darkMode ? 'text-cyan-300' : 'text-purple-700'
              }`}>
                DevContainer ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
              </h2>
              <div
                className={`prose ${darkMode ? 'prose-invert' : ''} max-w-none`}
                dangerouslySetInnerHTML={{ __html: envData.devcontainer }}
              />
            </section>

            {/* ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ */}
            <section className={`p-6 rounded-lg ${
              darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
            }`}>
              <h2 className={`text-2xl font-bold mb-4 ${
                darkMode ? 'text-cyan-300' : 'text-purple-700'
              }`}>
                ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰
              </h2>
              <div
                className={`prose ${darkMode ? 'prose-invert' : ''} max-w-none`}
                dangerouslySetInnerHTML={{ __html: envData.frontend }}
              />
            </section>

            {/* ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ */}
            <section className={`p-6 rounded-lg ${
              darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
            }`}>
              <h2 className={`text-2xl font-bold mb-4 ${
                darkMode ? 'text-cyan-300' : 'text-purple-700'
              }`}>
                ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰
              </h2>
              <div
                className={`prose ${darkMode ? 'prose-invert' : ''} max-w-none`}
                dangerouslySetInnerHTML={{ __html: envData.backend }}
              />
            </section>
          </div>
        )}
      </div>
    </main>
  );
}
```

---

## å®Ÿè£…æ‰‹é †ã®ã¾ã¨ã‚

### Step 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```bash
cd back
# ãƒ¢ãƒ‡ãƒ«ã« TaskGenerationJob ã‚’è¿½åŠ å¾Œ
alembic revision --autogenerate -m "Add task_generation_job table"
alembic upgrade head
```

### Step 2: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

1. `back/tasks/task_generation_tasks.py` ã‚’ä½œæˆ
2. `back/celery_app.py` ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¿½åŠ 
3. `back/routers/complete_task_generation.py` ã«éåŒæœŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 
4. `back/models/project_base.py` ã« `TaskGenerationJob` ãƒ¢ãƒ‡ãƒ«è¿½åŠ 

### Step 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

1. `front/src/libs/service/taskGenerationJobService.ts` ã‚’ä½œæˆ
2. `front/src/app/[userName]/[projectId]/page.tsx` ã‚’ä¿®æ­£ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆè¿½åŠ ï¼‰
3. `front/src/app/[userName]/[projectId]/env/page.tsx` ã‚’æ–°è¦ä½œæˆ

### Step 4: Celeryãƒ¯ãƒ¼ã‚«ãƒ¼ã®èµ·å‹•

```bash
cd back
celery -A celery_app worker --loglevel=info
```

### Step 5: å‹•ä½œç¢ºèª

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚¿ã‚¹ã‚¯ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`/env` ãƒšãƒ¼ã‚¸ã«è‡ªå‹•é·ç§»
3. ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ãŒè¡¨ç¤ºã•ã‚Œã‚‹
4. ã‚¿ã‚¹ã‚¯ç”Ÿæˆé€²æ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹
5. ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†å¾Œã€é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹
6. ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼/ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰ã«é·ç§»ã§ãã‚‹

---

## æ³¨æ„äº‹é …

### Redis ã®è¨­å®š

Celeryã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«RedisãŒå¿…è¦ã§ã™ã€‚`docker-compose.yml`ã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

```yaml
services:
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

volumes:
  redis_data:
```

### ç’°å¢ƒå¤‰æ•°

`back/.env` ã«ä»¥ä¸‹ã‚’è¿½åŠ :

```ini
REDIS_URL=redis://localhost:6379/0
```

### Celeryãƒ¯ãƒ¼ã‚«ãƒ¼ã®ç®¡ç†

æœ¬ç•ªç’°å¢ƒã§ã¯ã€Celeryãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’supervisorã‚„systemdã§ç®¡ç†ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---

## ãƒ†ã‚¹ãƒˆè¨ˆç”»

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

- [ ] `TaskGenerationJob` ãƒ¢ãƒ‡ãƒ«ã®CRUDãƒ†ã‚¹ãƒˆ
- [ ] `generate_complete_task_set_async` Celeryã‚¿ã‚¹ã‚¯ã®ãƒ†ã‚¹ãƒˆ
- [ ] ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹APIã®ãƒ†ã‚¹ãƒˆ

### çµ±åˆãƒ†ã‚¹ãƒˆ

- [ ] ã‚¿ã‚¹ã‚¯ç”Ÿæˆãƒ•ãƒ­ãƒ¼å…¨ä½“ã®ãƒ†ã‚¹ãƒˆï¼ˆé–‹å§‹ã€œå®Œäº†ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ†ã‚¹ãƒˆï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ãƒªãƒˆãƒ©ã‚¤ï¼‰
- [ ] é‡è¤‡å®Ÿè¡Œé˜²æ­¢ã®ãƒ†ã‚¹ãƒˆ

### E2Eãƒ†ã‚¹ãƒˆ

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒšãƒ¼ã‚¸ã‹ã‚‰env ãƒšãƒ¼ã‚¸ã¸ã®é·ç§»
- [ ] env ãƒšãƒ¼ã‚¸ã§ã®ã‚¿ã‚¹ã‚¯ç”Ÿæˆã¨ç’°å¢ƒæ§‹ç¯‰è³‡æ–™è¡¨ç¤º
- [ ] ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã®é€šçŸ¥ã¨ãƒšãƒ¼ã‚¸é·ç§»

---

## ä»Šå¾Œã®æ‹¡å¼µ

### Phase 3: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ï¼ˆWebSocketï¼‰

ãƒãƒ¼ãƒªãƒ³ã‚°ã®ä»£ã‚ã‚Šã«WebSocketã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€²æ—ã‚’é€šçŸ¥

### Phase 4: é€²æ—ã®è©³ç´°è¡¨ç¤º

å„ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆç”Ÿæˆã€è©•ä¾¡ã€ä¾å­˜é–¢ä¿‚ã€åº§æ¨™è¨ˆç®—ã€ä¿å­˜ï¼‰ã®è©³ç´°ãªé€²æ—ã‚’è¡¨ç¤º

### Phase 5: ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ©Ÿèƒ½

å®Ÿè¡Œä¸­ã®ã‚¿ã‚¹ã‚¯ç”Ÿæˆã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ 

---

## å‚è€ƒè³‡æ–™

- **Celery Documentation**: https://docs.celeryproject.org/
- **FastAPI Background Tasks**: https://fastapi.tiangolo.com/tutorial/background-tasks/
- **Next.js App Router**: https://nextjs.org/docs/app
- **Redis**: https://redis.io/docs/

---

## ã¾ã¨ã‚

ã“ã®ä»•æ§˜æ›¸ã«å¾“ã£ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ãŒå®Ÿç¾ã•ã‚Œã¾ã™:

1. âœ… ã‚¿ã‚¹ã‚¯ç”ŸæˆãŒéåŒæœŸã§å®Ÿè¡Œã•ã‚Œã‚‹
2. âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¾…ã¡æ™‚é–“ä¸­ã«ç’°å¢ƒæ§‹ç¯‰è³‡æ–™ã‚’ç¢ºèªã§ãã‚‹
3. âœ… ã‚¿ã‚¹ã‚¯ç”Ÿæˆå®Œäº†æ™‚ã«é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹
4. âœ… ã‚¹ãƒ ãƒ¼ã‚ºã«ã‚¿ã‚¹ã‚¯ãƒ•ãƒ­ãƒ¼/ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰ã«é·ç§»ã§ãã‚‹

ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒå¤§å¹…ã«å‘ä¸Šã—ã€åŠ¹ç‡çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚
